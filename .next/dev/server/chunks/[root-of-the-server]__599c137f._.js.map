{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/raymond-amem-aondoakura/Documents/softwares_I/web2_I/Cornerstone-Orphanage-Website/lib/mongodb.ts"],"sourcesContent":["import { MongoClient, Db } from 'mongodb'\n\nif (!process.env.MONGODB_URI) {\n  throw new Error('Please add your Mongo URI to .env')\n}\n\nconst uri = process.env.MONGODB_URI\nconst options = {}\n\nlet client: MongoClient\nlet clientPromise: Promise<MongoClient>\n\nif (process.env.NODE_ENV === 'development') {\n  // In development mode, use a global variable so that the value\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\n  let globalWithMongo = global as typeof globalThis & {\n    _mongoClientPromise?: Promise<MongoClient>\n  }\n\n  if (!globalWithMongo._mongoClientPromise) {\n    client = new MongoClient(uri, options)\n    globalWithMongo._mongoClientPromise = client.connect()\n  }\n  clientPromise = globalWithMongo._mongoClientPromise\n} else {\n  // In production mode, it's best to not use a global variable.\n  client = new MongoClient(uri, options)\n  clientPromise = client.connect()\n}\n\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\nexport default clientPromise\n\nexport async function getDatabase(): Promise<Db> {\n  const client = await clientPromise\n  return client.db('orphanage-site')\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU,CAAC;AAEjB,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,IAAI;IAIJ,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,IAAI,sHAAW,CAAC,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO;IACtD;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD;;uCAQe;AAER,eAAe;IACpB,MAAM,SAAS,MAAM;IACrB,OAAO,OAAO,EAAE,CAAC;AACnB","debugId":null}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///home/raymond-amem-aondoakura/Documents/softwares_I/web2_I/Cornerstone-Orphanage-Website/app/api/blogs/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getDatabase } from '@/lib/mongodb'\nimport { BlogPost } from '@/lib/blog-types'\nimport { auth } from '@clerk/nextjs/server'\nimport { ObjectId } from 'mongodb'\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    console.log('Fetching blog with ID:', id)\n\n    if (!ObjectId.isValid(id)) {\n      return NextResponse.json(\n        { error: 'Invalid blog ID' },\n        { status: 400 }\n      )\n    }\n\n    const db = await getDatabase()\n    const collection = db.collection<BlogPost>('blogs')\n\n    const blog = await collection.findOne({ _id: new ObjectId(id) })\n\n    if (!blog) {\n      return NextResponse.json(\n        { error: 'Blog not found' },\n        { status: 404 }\n      )\n    }\n\n    const serializedBlog = {\n      ...blog,\n      _id: blog._id?.toString(),\n      createdAt: blog.createdAt.toISOString(),\n      updatedAt: blog.updatedAt.toISOString(),\n    }\n\n    return NextResponse.json(serializedBlog)\n  } catch (error) {\n    console.error('Error fetching blog:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch blog' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { userId } = await auth()\n    if (!userId) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      )\n    }\n    \n    const { id } = await params\n    console.log(\"fetching blog with id\", id)\n\n    if (!ObjectId.isValid(id)) {\n      return NextResponse.json(\n        { error: 'Invalid blog ID' },\n        { status: 400 }\n      )\n    }\n\n    const body = await request.json()\n    const { title, description, content, featuredImage, category, published } = body\n\n    const db = await getDatabase()\n    const collection = db.collection<BlogPost>('blogs')\n\n    const updateData: Partial<BlogPost> = {\n      updatedAt: new Date(),\n    }\n\n    if (title !== undefined) updateData.title = title\n    if (description !== undefined) updateData.description = description\n    if (content !== undefined) updateData.content = content\n    if (featuredImage !== undefined) updateData.featuredImage = featuredImage\n    if (category !== undefined) updateData.category = category\n    if (published !== undefined) updateData.published = published\n\n    const result = await collection.findOneAndUpdate(\n      { _id: new ObjectId(id) },\n      { $set: updateData },\n      { returnDocument: 'after' }\n\n\n    )\n\n\n    if (!result){\n      return NextResponse.json(\n        { error: 'Blog not found' },\n        { status: 404 }\n      )\n    }\n\n    console.log(\"update result\", result)\n\n\n    const serializedBlog = {\n      ...result,\n      _id: result?._id?.toString(),\n      createdAt: result?.createdAt.toISOString(),\n      updatedAt: result?.updatedAt.toISOString(),\n    }\n\n    return NextResponse.json(serializedBlog)\n  } catch (error) {\n    console.error('Error updating blog:', error)\n    return NextResponse.json(\n      { error: 'Failed to update blog' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { userId } = await auth()\n\n    if (!userId) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      )\n    }\n\n    const { id } = await params\n\n    if (!ObjectId.isValid(id)) {\n      return NextResponse.json(\n        { error: 'Invalid blog ID' },\n        { status: 400 }\n      )\n    }\n\n    const db = await getDatabase()\n    const collection = db.collection<BlogPost>('blogs')\n\n    const result = await collection.deleteOne({ _id: new ObjectId(id) })\n\n    if (result.deletedCount === 0) {\n      return NextResponse.json(\n        { error: 'Blog not found' },\n        { status: 404 }\n      )\n    }\n\n    return NextResponse.json({ message: 'Blog deleted successfully' })\n  } catch (error) {\n    console.error('Error deleting blog:', error)\n    return NextResponse.json(\n      { error: 'Failed to delete blog' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}