{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/raymond-amem-aondoakura/Documents/softwares_I/web2_I/Cornerstone-Orphanage-Website/lib/mongodb.ts"],"sourcesContent":["import { MongoClient, Db } from 'mongodb'\n\nif (!process.env.MONGODB_URI) {\n  throw new Error('Please add your Mongo URI to .env')\n}\n\nconst uri = process.env.MONGODB_URI\nconst options = {}\n\nlet client: MongoClient\nlet clientPromise: Promise<MongoClient>\n\nif (process.env.NODE_ENV === 'development') {\n  // In development mode, use a global variable so that the value\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\n  let globalWithMongo = global as typeof globalThis & {\n    _mongoClientPromise?: Promise<MongoClient>\n  }\n\n  if (!globalWithMongo._mongoClientPromise) {\n    client = new MongoClient(uri, options)\n    globalWithMongo._mongoClientPromise = client.connect()\n  }\n  clientPromise = globalWithMongo._mongoClientPromise\n} else {\n  // In production mode, it's best to not use a global variable.\n  client = new MongoClient(uri, options)\n  clientPromise = client.connect()\n}\n\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\nexport default clientPromise\n\nexport async function getDatabase(): Promise<Db> {\n  const client = await clientPromise\n  return client.db('orphanage-site')\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU,CAAC;AAEjB,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,IAAI;IAIJ,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,IAAI,sHAAW,CAAC,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO;IACtD;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD;;uCAQe;AAER,eAAe;IACpB,MAAM,SAAS,MAAM;IACrB,OAAO,OAAO,EAAE,CAAC;AACnB","debugId":null}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///home/raymond-amem-aondoakura/Documents/softwares_I/web2_I/Cornerstone-Orphanage-Website/app/api/blogs/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getDatabase } from '@/lib/mongodb'\nimport { BlogPost, BlogFilter } from '@/lib/blog-types'\nimport { auth } from '@clerk/nextjs/server'\n\nexport async function GET(request: NextRequest) {\n  try {\n    const searchParams = request.nextUrl.searchParams\n    const filter = (searchParams.get('filter') as BlogFilter) || 'all'\n    const includeDrafts = ['1', 'true'].includes((searchParams.get('includeDrafts') || '').toLowerCase())\n\n    const db = await getDatabase()\n    const collection = db.collection<BlogPost>('blogs')\n\n    // Only include drafts if explicitly requested AND the user is authenticated\n    let canSeeDrafts = false\n    if (includeDrafts) {\n      const { userId } = await auth()\n      canSeeDrafts = Boolean(userId)\n    }\n\n    const now = new Date()\n    const query: any = {}\n    if (!canSeeDrafts) query.published = true\n\n    switch (filter) {\n      case 'today': {\n        const startOfDay = new Date()\n        startOfDay.setHours(0, 0, 0, 0)\n        const endOfDay = new Date()\n        endOfDay.setHours(23, 59, 59, 999)\n        query.createdAt = { $gte: startOfDay, $lte: endOfDay }\n        break\n      }\n      case 'lastMonth': {\n        const thirtyDaysAgo = new Date()\n        thirtyDaysAgo.setDate(now.getDate() - 30)\n        query.createdAt = { $gte: thirtyDaysAgo }\n        break\n      }\n      case 'latest':\n        // No extra query; we'll just limit\n        break\n      case 'all':\n      default:\n        break\n    }\n\n    const blogs = await collection\n      .find(query)\n      .sort({ createdAt: -1 })\n      .limit(filter === 'latest' ? 10 : 100)\n      .toArray()\n\n    const serializedBlogs = blogs.map(blog => ({\n      ...blog,\n      _id: blog._id?.toString(),\n      createdAt: blog.createdAt.toISOString(),\n      updatedAt: blog.updatedAt.toISOString(),\n    }))\n\n    return NextResponse.json(serializedBlogs)\n  } catch (error) {\n    console.error('Error fetching blogs:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch blogs' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { userId } = await auth()\n    \n    if (!userId) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      )\n    }\n    \n    const body = await request.json()\n    const { title, description, content, featuredImage, category, published = true } = body\n    \n    if (!title || !description || !content) {\n      return NextResponse.json(\n        { error: 'Missing required fields' },\n        { status: 400 }\n      )\n    }\n    \n    const db = await getDatabase()\n    const collection = db.collection<BlogPost>('blogs')\n    \n    const newBlog: Omit<BlogPost, '_id'> = {\n      title,\n      description,\n      content,\n      featuredImage,\n      category,\n      author: userId, // You can get user's name from Clerk if needed\n      authorId: userId,\n      published,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    }\n    \n    const result = await collection.insertOne(newBlog as any)\n    \n    return NextResponse.json({\n      _id: result.insertedId.toString(),\n      ...newBlog,\n      createdAt: newBlog.createdAt.toISOString(),\n      updatedAt: newBlog.updatedAt.toISOString(),\n    }, { status: 201 })\n  } catch (error) {\n    console.error('Error creating blog:', error)\n    return NextResponse.json(\n      { error: 'Failed to create blog' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}